(function(e){function t(t){for(var n,s,o=t[0],d=t[1],l=t[2],u=0,h=[];u<o.length;u++)s=o[u],Object.prototype.hasOwnProperty.call(a,s)&&a[s]&&h.push(a[s][0]),a[s]=0;for(n in d)Object.prototype.hasOwnProperty.call(d,n)&&(e[n]=d[n]);c&&c(t);while(h.length)h.shift()();return r.push.apply(r,l||[]),i()}function i(){for(var e,t=0;t<r.length;t++){for(var i=r[t],n=!0,o=1;o<i.length;o++){var d=i[o];0!==a[d]&&(n=!1)}n&&(r.splice(t--,1),e=s(s.s=i[0]))}return e}var n={},a={app:0},r=[];function s(t){if(n[t])return n[t].exports;var i=n[t]={i:t,l:!1,exports:{}};return e[t].call(i.exports,i,i.exports,s),i.l=!0,i.exports}s.m=e,s.c=n,s.d=function(e,t,i){s.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},s.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},s.t=function(e,t){if(1&t&&(e=s(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(s.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)s.d(i,n,function(t){return e[t]}.bind(null,n));return i},s.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return s.d(t,"a",t),t},s.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},s.p="/dist/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],d=o.push.bind(o);o.push=t,o=o.slice();for(var l=0;l<o.length;l++)t(o[l]);var c=d;r.push([0,"chunk-vendors"]),i()})({0:function(e,t,i){e.exports=i("56d7")},"51c6":function(e,t,i){},"56d7":function(e,t,i){"use strict";i.r(t);i("e260"),i("e6cf"),i("cca6"),i("a79d");var n=i("2b0e"),a=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-app",[i("ViewPort")],1)},r=[],s=function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("div",{attrs:{id:"ViewPort"}},[i("NavPanel",{attrs:{layertree:e.layertree,layervisibles:e.layervisible,layerexpanded:e.layerexpanded,id:"sidebar"},on:{input:e.inputdone,adjast:e.adjastdone,fileinput:e.fileinputdone}}),i("div",{ref:"stage",attrs:{id:"viewmain"}})],1)},o=[],d=(i("b0c0"),i("caad"),i("2532"),i("d3b7"),i("25f0"),function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("v-card",{staticClass:"d-flex",attrs:{id:"navmenu",flat:"",tile:"",height:"100vh",width:e.openLayer?e.navwidth+e.layerwidth:e.navwidth}},[i("v-navigation-drawer",{ref:"navdrawer",attrs:{"mini-variant":"",permanent:""}},[i("v-list",{attrs:{dense:"",nav:""}},[i("v-list-item",{attrs:{link:""},on:{click:function(t){e.openLayer=!e.openLayer}}},[i("v-list-item-icon",[i("v-icon",[e._v("mdi-layers-outline")])],1),i("v-list-item-content",[e._v(" Layer ")])],1),i("v-list-item",{attrs:{link:""}},[i("v-list-item-icon",[i("label",{staticClass:"navicon",attrs:{for:"fileinput"}},[i("v-icon",[e._v("mdi-folder-open-outline")]),i("input",{staticStyle:{display:"none"},attrs:{type:"file",id:"fileinput",name:"fileinput",accept:".3dm"}})],1)]),i("v-list-item-content",[e._v(" File ")])],1),i("v-list-item",{attrs:{link:""}},[i("v-list-item-icon",[i("v-icon",{on:{click:e.adjastdone}},[e._v("mdi-fit-to-page-outline")])],1),i("v-list-item-content",[e._v(" Adjast Object ")])],1)],1)],1),i("v-card",{directives:[{name:"show",rawName:"v-show",value:e.openLayer,expression:"openLayer"}],attrs:{height:"100%",flat:"",tile:""}},[i("v-navigation-drawer",{ref:"layerdrawer",attrs:{width:e.layerwidth,permanent:""}},[i("v-treeview",{attrs:{selectable:"",dense:"","on-icon":"mdi-eye","off-icon":"mdi-eye-off-outline",items:e.layertree,value:e.layervisibles,open:e.layerexpanded},on:{input:e.inputdone}})],1)],1)],1)}),l=[],c={name:"NavPanel",props:["layertree","layervisibles","layerexpanded"],data:function(){return{openLayer:!1,minnavwidth:200,navwidth:56,layerwidth:200}},methods:{resize:function(e){document.body.style.cursor="ew-resize",this.layerwidth=Math.max(e.clientX-this.navwidth,this.minnavwidth)},setEvents:function(){var e=this,t=this.$refs.layerdrawer.$el,i=t.querySelector(".v-navigation-drawer__border");i.addEventListener("mousedown",(function(i){i.stopPropagation(),i.preventDefault(),t.style.transition="initial",document.addEventListener("mousemove",e.resize,!1)}),!1),i.addEventListener("mouseenter",(function(){document.body.style.cursor="ew-resize"}),!1),i.addEventListener("mouseleave",(function(){document.body.style.cursor=""}),!1),document.addEventListener("mouseup",(function(){t.style.transition="",document.body.style.cursor="",document.removeEventListener("mousemove",e.resize,!1)}),!1)},inputdone:function(e){this.$emit("input",e)},adjastdone:function(){this.$emit("adjast")},fileinputdone:function(e){this.$emit("fileinput",e)},fileChange:function(e){var t=e.target,i=t.files[0];this.fileinputdone(i)}},mounted:function(){this.setEvents();var e=document.getElementById("fileinput");e.addEventListener("change",this.fileChange,!1)}},u=c,h=(i("b173"),i("2877")),p=i("6544"),v=i.n(p),f=i("b0af"),m=i("132d"),y=i("8860"),w=i("da13"),b=i("5d23"),g=i("34c3"),j=i("f774"),O=i("eb2a"),x=Object(h["a"])(u,d,l,!1,null,"7d132c08",null),L=x.exports;v()(x,{VCard:f["a"],VIcon:m["a"],VList:y["a"],VListItem:w["a"],VListItemContent:b["a"],VListItemIcon:g["a"],VNavigationDrawer:j["a"],VTreeview:O["a"]});var P=i("5a89"),E=i("4721"),_=i("b07c"),D={components:{NavPanel:L},name:"ViewPort",data:function(){var e=new P["B"],t=new P["L"]({antialias:!0,logarithmicDepthBuffer:!0}),i=new P["v"](45,1,1,2e5);i.up.set(0,0,1);var n=new P["j"](16777215,4473924,1),a=new P["f"](16777215,3);a.position.set(1,-2,2),a.castShadow=!0;var r=new _["a"];return{scene:e,renderer:t,camera:i,controls:null,light:n,dirlight:a,loader:r,loadObj:null,loadObjEdges:{},reader:new FileReader,layertree:[],layervisible:[],layerexpanded:[]}},created:function(){this.scene.add(this.camera),this.scene.add(this.light),this.scene.add(this.dirlight),this.scene.background=new P["e"](10526880)},mounted:function(){this.$refs.stage.appendChild(this.renderer.domElement),this.renderer.setPixelRatio(window.devicePixelRatio),this.renderer.setSize(window.innerWidth,window.innerHeight),this.renderer.outputEncoding=P["M"],this.renderer.shadowMap.enabled=!0,this.renderer.shadowMap.type=P["u"],window.addEventListener("resize",this.onWindowResize),this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.position.set(3,3,6),this.camera.updateProjectionMatrix(),this.controls=new E["a"](this.camera,this.renderer.domElement),this.controls.target.set(0,0,0),this.controls.update(),this.reader.addEventListener("load",this.fileLoad,!1),this.loader.setLibraryPath("https://cdn.jsdelivr.net/npm/rhino3dm@0.15.0-beta/"),this.load3dm("sample.3dm"),this.animate()},methods:{animate:function(){requestAnimationFrame(this.animate),this.renderer.render(this.scene,this.camera)},onWindowResize:function(){this.camera.aspect=window.innerWidth/window.innerHeight,this.camera.updateProjectionMatrix(),this.renderer.setSize(window.innerWidth,window.innerHeight)},load3dm:function(e){this.loader.load(e,function(e){if(this.loadObj){this.scene.remove(this.loadObj);while(this.loadObjEdges.length>0)this.scene.remove(this.loadObjEdges.pop())}this.loadObj=e,this.scene.add(this.loadObj),this.layertree=[],this.layervisible=[],this.layerexpanded=[];var t={"00000000-0000-0000-0000-000000000000":{id:-1,parents:null,child:[],data:{}}};for(var i in e.userData.layers)if(Object.hasOwnProperty.call(e.userData.layers,i)){var n=e.userData.layers[i];t[n.id]={id:i,parents:n.parentLayerId,child:[],data:{name:n.name,color:n.color,expanded:n.expanded,visible:n.visible}},n.visible&&this.layervisible.push(i),n.expanded&&this.layerexpanded.push(i)}for(var a in e.userData.layers)if(Object.hasOwnProperty.call(e.userData.layers,a)){var r=e.userData.layers[a];t[r.parentLayerId].child.push(r.id)}this.layertree=this.bakeTree(t,"00000000-0000-0000-0000-000000000000").children,e.traverse(function(t){if(Object.prototype.hasOwnProperty.call(t.userData,"attributes")){var i=t.userData.attributes.layerIndex;if("Mesh"==t.type){var n=new P["g"](t.geometry,60),a=new P["m"](n,new P["l"]({color:0}));this.loadObjEdges[t.uuid]=a,a.visible=e.userData.layers[i].visible,this.scene.add(a)}t.visible=e.userData.layers[i].visible}}.bind(this)),this.adjustCamera(e)}.bind(this))},bakeTree:function(e,t){var i=e[t],n=[];for(var a in i.child){var r=e[i.child[a]];0==r.child.length?n.push({id:r.id,name:r.data.name}):n.push(this.bakeTree(e,i.child[a]))}return{id:i.id,name:i.data.name,children:n}},adjustCamera:function(e){var t=new P["a"];t.setFromObject(e);var i=t.getBoundingSphere(new P["C"]),n=this.camera.getEffectiveFOV(),a=this.camera.fov*this.camera.aspect,r=Math.min(n,a),s=new P["K"];this.camera.getWorldDirection(s);var o=Math.sin(r*Math.PI/360),d=s.clone(),l=i.radius/o;d.multiplyScalar(-l);var c=i.center.clone().add(d);this.camera.position.copy(c),this.camera.far=5*l,this.camera.lookAt(i.center),this.camera.updateProjectionMatrix(),this.controls.target.copy(i.center),this.controls.update()},inputdone:function(e){this.scene.traverse(function(t){Object.hasOwnProperty.call(t.userData,"attributes")&&"layerIndex"in t.userData.attributes&&(t.visible=e.includes(t.userData.attributes.layerIndex.toString()),"Mesh"==t.type&&(this.loadObjEdges[t.uuid].visible=t.visible))}.bind(this))},adjastdone:function(){this.adjustCamera(this.loadObj)},fileinputdone:function(e){this.reader.readAsDataURL(e),this.load3dm(this.reader.result),console.log("file changed")},fileLoad:function(){this.load3dm(this.reader.result)}}},M=D,V=(i("8391"),Object(h["a"])(M,s,o,!1,null,"9f765bce",null)),k=V.exports,S={name:"App",components:{ViewPort:k},data:function(){return{}}},I=S,C=i("7496"),z=Object(h["a"])(I,a,r,!1,null,"6796f9de",null),$=z.exports;v()(z,{VApp:C["a"]});var T=i("f309");n["a"].use(T["a"]);var W=new T["a"]({});n["a"].config.productionTip=!1,new n["a"]({vuetify:W,render:function(e){return e($)}}).$mount("#app")},8391:function(e,t,i){"use strict";i("51c6")},aef3:function(e,t,i){},b173:function(e,t,i){"use strict";i("aef3")}});
//# sourceMappingURL=app.79484459.js.map